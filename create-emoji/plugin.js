(()=>{var X=Object.create;var S=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var W=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Q=(t,e)=>{for(var n in e)S(t,n,{get:e[n],enumerable:!0})},z=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of V(e))!Z.call(t,i)&&i!==n&&S(t,i,{get:()=>e[i],enumerable:!(s=F(e,i))||s.enumerable});return t};var b=(t,e,n)=>(n=t!=null?X(W(t)):{},z(e||!t||!t.__esModule?S(n,"default",{value:t,enumerable:!0}):n,t)),Y=t=>z(S({},"__esModule",{value:!0}),t);var $=K((ge,B)=>{B.exports=shelter.solidWeb});var ue={};Q(ue,{onLoad:()=>de,onUnload:()=>me});var T=b($(),1),H=b($(),1),J=b($(),1),U=b($(),1),P=b($(),1),I=b($(),1),C=b($(),1),ee=(0,T.template)('<div><div class="submenuPaddingContainer-QgnL1r"><div class="submenu-3ycVEH menu-2TXYjN"><div></div></div></div></div>',8),te=(0,T.template)('<div><div style="margin-left: 0; margin-right: 8px;"><img width="18" height="18" style="border-radius: 50%;"></div><div class="label-" style="-webkit-box-flex: 1; -ms-flex: 1 1 auto; flex: 1 1 auto; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><div class="subtext-" style="color: var(--text-muted); font-size: 12px; line-height: 16px;"></div></div></div>',9),ne=(0,T.template)('<div><div id="message-create-emoji" role="menuitem" tabindex="-1" data-menu-item="true"><div>Create Emoji: </div><div class="iconContainer-Ksy8Oj"><svg class="caret-1TZU-U" role="img" width="24" height="24" viewBox="0 0 24 24"><g fill="none" fillRule="evenodd"><polygon fill="currentColor" fillRule="nonzero" points="8.47 2 6.12 4.35 13.753 12 6.12 19.65 8.47 22 18.47 12"></polygon><polygon points="0 0 24 0 24 24 0 24"></polygon></g></svg></div></div></div>',16),{flux:_,solid:ie,util:M}=shelter,se=["mp4","mov","webm","ogg","mp3","wav","flac","svg"];function oe(t){let e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(t),i=s.byteLength,d=i%3,r=i-d,m,l,p,y,o;for(let h=0;h<r;h=h+3)o=s[h]<<16|s[h+1]<<8|s[h+2],m=(o&16515072)>>18,l=(o&258048)>>12,p=(o&4032)>>6,y=o&63,e+=n[m]+n[l]+n[p]+n[y];return d==1?(o=s[r],m=(o&252)>>2,l=(o&3)<<4,e+=n[m]+n[l]+"=="):d==2&&(o=s[r]<<8|s[r+1],m=(o&64512)>>10,l=(o&1008)>>4,p=(o&15)<<2,e+=n[m]+n[l]+n[p]+"="),e}async function re(t,e,n){let{GatewayConnectionStore:s}=_.stores,i=s.getSocket().handleIdentify(),d;try{d=await fetch(e,{mode:"cors"})}catch(r){M.log(["Failed to fetch emoji",e,r],"error");return}if(d)try{let r=d.headers.get("Content-Type"),m=oe(await d.arrayBuffer());_.dispatcher.dispatch({type:"EMOJI_UPLOAD_START",guildId:t.id}),await fetch(`${window.GLOBAL_ENV.API_ENDPOINT}/guilds/${t.id}/emojis`,{method:"POST",body:JSON.stringify({image:`data:${r};base64,${m}`,name:n}),headers:{"Content-Type":"application/json",Authorization:i.token,"X-Super-Properties":btoa(JSON.stringify(i.properties))}}).then(()=>{_.dispatcher.dispatch({type:"EMOJI_UPLOAD_STOP",guildId:t.id})},l=>(_.dispatcher.dispatch({type:"EMOJI_UPLOAD_STOP",guildId:t.id}),Promise.reject(l)))}catch(r){M.log(["Failed to create emoji",e,r],"error")}}function ae(t){let{EmojiStore:e}=_.stores,n=t.getMaxEmojiSlots(),s=e.getGuildEmoji(t.id).filter(r=>!r.managed),i=s.filter(r=>!r.animated),d=s.filter(r=>r.animated);return{normal:i.length,animated:d.length,max:n}}function ce(t,e,n,s,i){let{GuildStore:d,SortedGuildStore:r,PermissionStore:m}=_.stores,l=r.getGuildsTree().root.children.flatMap(c=>c.type=="guild"?c:c.children),p=Object.values(d.getGuilds()).filter(c=>m.can(1n<<30n,c)).sort((c,N)=>{let f=l.findIndex(a=>a.id==c.id),g=l.findIndex(a=>a.id==N.id);return f-g}),y=t.parentElement.className,o=t.childNodes[0].className,h=function(c){c.target.className=e+" focused-3LIdPu",t.setAttribute("aria-activedescendant",c.target.id)},E=function(c){c.target.className=e},L=function(){};return(()=>{let c=ee.cloneNode(!0),N=c.firstChild,f=N.firstChild,g=f.firstChild;return c.className=y,g.className=o,(0,C.insert)(g,()=>p.map(a=>{let v=ae(a),A=a.getIconURL(24),x=i?v.animated>=v.max:v.normal>=v.max;return(()=>{let u=te.cloneNode(!0),w=u.firstChild,O=w.firstChild,R=w.nextSibling,G=R.firstChild;return(0,I.addEventListener)(u,"click",x?L:()=>{re(a,n,s),_.dispatcher.dispatch({type:"CONTEXT_MENU_CLOSE"})},!0),(0,I.addEventListener)(u,"mouseleave",x?L:E),(0,I.addEventListener)(u,"mouseenter",x?L:h),u.className=e,w.className=`iconContainerLeft- iconContainer- ${x?"disabled-":""}`,(0,P.setAttribute)(O,"src",A),(0,C.insert)(R,()=>a.name,G),(0,C.insert)(G,()=>`${v.normal}/${v.max} normal, ${v.animated}/${v.max} animated`),(0,U.effect)(j=>{let k=`message-create-emoji--${a.id}`,D=`${x?"opacity: 0.5;":""}`;return k!==j._v$&&(0,P.setAttribute)(u,"id",j._v$=k),j._v$2=(0,J.style)(u,D,j._v$2),j},{_v$:void 0,_v$2:void 0}),u})()})),c})()}function le(t,e){let n=e.target.href??e.target.src;if(!n||n.indexOf("tenor.com/view")>-1)return;if(e.target.classList.contains("emoji")&&n.indexOf("cdn.discordapp.com/emojis/")>-1){let l=new URL(n),p=l.pathname.match(/(\d+)/)[1],o=e.message.content.match(new RegExp("<(a)?:\\w+:"+p+">"))?.[1]??!1;l.search="",n=l.href,n=n.replace(".webp",o?".gif":".png")}let i=n.substring(n.lastIndexOf("/"),n.lastIndexOf(".")).replace(/[^a-zA-Z0-9_]/g,"").slice(0,32);for(;i.length<2;)i+="_";e.target.ariaLabel&&(i=e.target.ariaLabel.slice(1,-1).replace(/~\d+$/,""));let d=n.substring(n.lastIndexOf(".")+1,n.lastIndexOf(".")+4);if(se.includes(d))return;let r=e.attachment?.content_type?e.attachment.content_type=="image/gif":d=="gif",m=t.querySelector("[id=message-copy-native-link]");if(m){let l=m.className,[p,y]=ie.createSignal(!1),o=ce(t,l,n,i,r),h=function(f){if(t.setAttribute("aria-activedescendant",f.target.id),!p()){y(!0);let g=t.querySelector(`[class*=focused-]:not([id=${f.target.id}])`);g&&(g.className=g.className.replace(/focused-\w+/,""));let a=f.target.getBoundingClientRect();o.style.position="fixed",o.style.left=`${a.x+a.width+4}px`,o.style.top=`${a.y}px`,f.target.after(o);let v=o.getBoundingClientRect();o.style.top=`${a.y+a.height-v.height}px`}},E=function(f){y(!1),o.remove()};t.addEventListener("mouseleave",E);let L=function(f){t.querySelector("[class*=focused-]:not([id^=message-create-emoji])")&&E()};t.addEventListener("mouseover",L);let c=(()=>{let f=ne.cloneNode(!0),g=f.firstChild,a=g.firstChild,v=a.firstChild,A=a.nextSibling,x=A.firstChild;return g.addEventListener("mouseenter",h),(0,C.insert)(a,i,null),(0,P.setAttribute)(x,"aria-hidden",!0),(0,U.effect)(u=>{let w=l+(p()?" focused-3LIdPu":""),O=m.childNodes[0].className;return w!==u._v$3&&(g.className=u._v$3=w),O!==u._v$4&&(a.className=u._v$4=O),u},{_v$3:void 0,_v$4:void 0}),f})();m.before(c);let N=t.parentElement;N.style.top=`${Number(N.style.top.replace("px",""))-c.clientHeight}px`}}var q=[];function de(){q.push(_.intercept(t=>{if(t.type=="CONTEXT_MENU_OPEN"){let e=t.contextMenu,n;if(e.render){let s=e.render;e.render=function(){let i=s.apply(null,arguments);return n=i.props,i}}else if(e.renderLazy){let s=e.renderLazy;e.renderLazy=async function(){let i=await s.apply(null,arguments);return function(d){let r=i.apply(null,arguments);return n=r.props,r}}}setTimeout(()=>{let s=document.querySelector("div[class^=menu-][id=message]");if(s)try{le(s,n)}catch(i){M.log(i,"error")}})}}))}function me(){q.forEach(t=>t())}(0,H.delegateEvents)(["click"]);return Y(ue);})();
/**
 * @license MIT
 * Copyright 2011 Jon Leighton
 */
